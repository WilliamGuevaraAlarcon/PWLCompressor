context("This test also contains segments which are not at the beginning or end, and which violate the strict admissibility condtions")

test_that("test-StrictAdmissibility-Third", {
  Sample = c( 5.021,  5.074,  5.199,  5.212,  5.292,  5.345,  5.539,  5.642,  5.966,  6.189, 46.223,
             46.241, 46.732, 47.343, 47.363, 47.402, 48.391,  48.82, 49.049, 49.305, 69.698,
             70.113, 70.295, 70.712,   71.6, 72.805, 74.392, 75.707, 78.212, 78.547)
  Accuracy = 0.00089

  #result: [5.021000  5.021000  5.074000  5.074000  5.086142  5.437858  5.531185  5.649815  6.505185, 46.061333 47.706667 48.334187 49.448313 69.600000 70.809000 71.600000 71.600000 72.805000, 72.805000 74.392000 74.392000 75.707000 75.707000 78.212000 78.212000 78.547000 78.547000]
  #      : [0.00000000 0.03333333 0.03333333 0.06666667 0.06666667 0.20000000 0.20000000 0.26666667, 0.33333333 0.33333333 0.53333333 0.53333333 0.66666667 0.66666667 0.80000000 0.80000000, 0.83333333 0.83333333 0.86666667 0.86666667 0.90000000 0.90000000 0.93333333 0.93333333, 0.96666667 0.96666667 1.00000000]
  #      : [4.94912  5.63188  6.52312 45.80501 49.56879 69.60000 70.80900 71.60000 71.60000 72.80500, 72.80500 73.92340 76.17560 78.10935 78.64965]
  #      : [0.0000000 0.2666667 0.3333333 0.3333333 0.6666667 0.6666667 0.8000000 0.8000000 0.8333333, 0.8333333 0.8666667 0.8666667 0.9333333 0.9333333 1.0000000]
  CompressedSampleStrict    = PWLCompressor(Sample, Accuracy, check.strict.adm = TRUE)
  CompressedSampleNonStrict = PWLCompressor(Sample, Accuracy, check.strict.adm = FALSE)
  print(CompressedSampleStrict)
  print(CompressedSampleNonStrict)

  expect_equal(CompressedSampleStrict$X, c(5.021, 5.021, 5.074, 5.074, 5.086, 5.438, 5.531, 5.65, 6.505, 46.061, 47.707, 48.334, 49.448, 69.6, 70.809, 71.6, 71.6, 72.805, 72.805, 74.392, 74.392, 75.707, 75.707, 78.212, 78.212, 78.547, 78.547), tolerance = 1e-03)
  expect_equal(CompressedSampleStrict$Y, c(0.0, 0.033, 0.033, 0.067, 0.067, 0.2, 0.2, 0.267, 0.333, 0.333, 0.533, 0.533, 0.667, 0.667, 0.8, 0.8, 0.833, 0.833, 0.867, 0.867, 0.9, 0.9, 0.933, 0.933, 0.967, 0.967, 1.0), tolerance = 1e-03)
  expect_equal(CompressedSampleNonStrict$X, c(4.949, 5.632, 6.523, 45.805, 49.569, 69.6, 70.809, 71.6, 71.6, 72.805, 72.805, 73.923, 76.176, 78.109, 78.65), tolerance = 1e-03)
  expect_equal(CompressedSampleNonStrict$Y, c(0.0, 0.267, 0.333, 0.333, 0.667, 0.667, 0.8, 0.8, 0.833, 0.833, 0.867, 0.867, 0.933, 0.933, 1.0), tolerance = 1e-03)
})
